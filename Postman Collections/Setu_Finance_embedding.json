{
	"info": {
		"_postman_id": "f6ac34b2-d1b5-430a-978c-342b74ce66e8",
		"name": "FIU service - public",
		"schema": "https://schema.getpostman.com/json/collection/v2.0.0/collection.json"
	},
	"item": [
		{
			"name": "Consent APIs",
			"item": [
				{
					"name": "Create new consent",
					"event": [
						{
							"listen": "test",
							"script": {
								"id": "662145c6-8448-487b-bb40-c2972de3dc6e",
								"exec": [
									"if(pm.response.code == 201) {",
									"    const parsedJson = pm.response.json()",
									"    pm.collectionVariables.set(\"consent_request_id\", parsedJson.id);",
									"}"
								],
								"type": "text/javascript"
							}
						},
						{
							"listen": "prerequest",
							"script": {
								"id": "6c1423de-2d7d-44d4-974e-228548ff2c8d",
								"exec": [
									""
								],
								"type": "text/javascript"
							}
						}
					],
					"_postman_id": "a0b91c47-1220-434d-b197-2ea9774bed21",
					"protocolProfileBehavior": {
						"disableBodyPruning": true
					},
					"request": {
						"auth": {
							"type": "oauth2",
							"oauth2": {
								"client_authentication": "body",
								"accessTokenUrl": "https://prod.setu.so/api/v2/auth/token",
								"clientSecret": "9c2fc756-3d17-46d6-b28d-be4d71953e83",
								"clientId": "255d0b6c-492d-44cf-8581-e9494c7b0914",
								"grant_type": "client_credentials",
								"tokenName": "SETU AA Token",
								"addTokenTo": "header"
							}
						},
						"method": "POST",
						"header": [
							{
								"key": "x-client-id",
								"value": "255d0b6c-492d-44cf-8581-e9494c7b0914",
								"type": "text"
							},
							{
								"key": "x-client-secret",
								"value": "9c2fc756-3d17-46d6-b28d-be4d71953e83",
								"type": "text"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"Detail\": {\n        \"consentStart\": \"{{$isoTimestamp}}\",\n        \"consentExpiry\": \"2023-04-23T05:44:53.822Z\",\n        \"Customer\": {\n            \"id\": \"{{mobile_number}}@onemoney\"\n        },\n        \"FIDataRange\": {\n            \"from\": \"2021-04-01T00:00:00Z\",\n            \"to\": \"2021-10-01T00:00:00Z\"\n        },\n        \"consentMode\": \"STORE\",\n        \"consentTypes\": [\n            \"TRANSACTIONS\",\n            \"PROFILE\",\n            \"SUMMARY\"\n        ],\n        \"fetchType\": \"PERIODIC\",\n        \"Frequency\": {\n            \"value\": 30,\n            \"unit\": \"MONTH\"\n        },\n        \"DataFilter\": [\n            {\n                \"type\": \"TRANSACTIONAMOUNT\",\n                \"value\": \"5000\",\n                \"operator\": \">=\"\n            }\n        ],\n        \"DataLife\": {\n            \"value\": 1,\n            \"unit\": \"MONTH\"\n        },\n        \"DataConsumer\": {\n            \"id\": \"setu-fiu-id\"\n        },\n        \"Purpose\": {\n            \"Category\": {\n                \"type\": \"string\"\n            },\n            \"code\": \"101\",\n            \"text\": \"Loan underwriting\",\n            \"refUri\": \"https://api.rebit.org.in/aa/purpose/101.xml\"\n        },\n        \"fiTypes\": [\n            \"DEPOSIT\"\n        ]\n    },\n    \"context\": [\n        {\n            \"key\": \"accounttype\",\n            \"value\": \"CURRENT\"\n        }\n    ],\n    \"redirectUrl\": \"https://setu.co\"\n}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": "{{base_url}}/consents",
						"description": "Call this API to create a consent request. Update Customer.id with your mobile number to be able to test the flow. This API responds with a **url** to initiate consent review flow as part of the response, with consent status as PENDING.  \nRead more about Consent Review by Customer here(https://docs.setu.co/data/account-aggregator/api-integration/consent-flow#consent-review-by-customer)"
					},
					"response": []
				},
				{
					"name": "Get a consent",
					"event": [
						{
							"listen": "test",
							"script": {
								"id": "404b5c39-8a5b-4364-bf79-9c1ae29bf881",
								"exec": [
									""
								],
								"type": "text/javascript"
							}
						}
					],
					"_postman_id": "10762a51-b650-42a5-a402-a01325a201f8",
					"protocolProfileBehavior": {
						"disableBodyPruning": true
					},
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "x-client-id",
								"value": "{{client_id}}",
								"type": "text"
							},
							{
								"key": "x-client-secret",
								"value": "{{client_secret}}",
								"type": "text"
							}
						],
						"url": {
							"raw": "{{base_url}}/consents/:id",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"consents",
								":id"
							],
							"variable": [
								{
									"id": "bd8c326e-20be-405a-be50-6fce1fe0153e",
									"key": "id",
									"value": "{{consent_request_id}}",
									"type": "string"
								}
							]
						},
						"description": "Call this API to get the updated status of a consent request by passing its unique `id`. If the consent is approved, the Status in the response will be `ACTIVE`. After this, you can now initiate Data flow for the approved consent request."
					},
					"response": []
				}
			],
			"_postman_id": "1744ffbd-bcca-4b44-b361-cd38027732bb"
		},
		{
			"name": "Data session APIs",
			"item": [
				{
					"name": "Create new data session",
					"event": [
						{
							"listen": "test",
							"script": {
								"id": "07acaddd-7124-4b08-82cb-180a8ce71d0e",
								"exec": [
									"if(pm.response.code == 201) {",
									"    const parsedJson = pm.response.json()",
									"    pm.collectionVariables.set(\"fi_data_request_id\", parsedJson.id);",
									"}"
								],
								"type": "text/javascript"
							}
						}
					],
					"_postman_id": "45938220-5905-44e2-9acc-7182b558297f",
					"protocolProfileBehavior": {
						"disableBodyPruning": true
					},
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "x-client-id",
								"value": "255d0b6c-492d-44cf-8581-e9494c7b0914",
								"type": "text"
							},
							{
								"key": "x-client-secret",
								"value": "9c2fc756-3d17-46d6-b28d-be4d71953e83",
								"type": "text"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"consentId\": \"0aba0bb6-06f3-449b-9bac-505423b7c002\",\n  \"DataRange\": {\n    \"from\": \"2023-07-01T00:00:00.000Z\",\n    \"to\": \"2023-07-31T23:59:59.999Z\"\n  },\n  \"format\": \"json\"\n}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": "{{base_url}}/sessions",
						"description": "Call this API to create a data session against the approved `consentId`. Specify the format in which you wish to receive the decrypted financial data, this can be **xml** or **json.** Make sure that values of `DataRange` array in the body, matches or is within the `FIDataRange` specified in the Create consent request API."
					},
					"response": []
				},
				{
					"name": "Get data",
					"_postman_id": "faaa7831-9185-44bb-9031-295612bfe30c",
					"protocolProfileBehavior": {
						"disableBodyPruning": true
					},
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "x-client-id",
								"value": "{{client_id}}",
								"type": "text"
							},
							{
								"key": "x-client-secret",
								"value": "{{client_secret}}",
								"type": "text"
							}
						],
						"url": {
							"raw": "{{base_url}}/sessions/:id",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"sessions",
								":id"
							],
							"variable": [
								{
									"id": "dfc7985b-9e21-4886-9d1b-29a2ba9c9dc0",
									"key": "id",
									"value": "{{fi_data_request_id}}",
									"type": "string"
								}
							]
						},
						"description": "The notification URL you have configured with Setu will be used to notify you when data is ready to be fetched. Then, use the `id` received in Create Data Session API in the previous step to call this API to fetch the financial information of your user."
					},
					"response": []
				}
			],
			"_postman_id": "f83e750c-bc5e-4e55-9b00-ad4571d9eee6"
		},
		{
			"name": "FIU Data",
			"item": [
				{
					"name": "Get FIPs List",
					"_postman_id": "32f26047-6945-4caf-9eba-fd670809365f",
					"protocolProfileBehavior": {
						"disableBodyPruning": true
					},
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "x-client-id",
								"value": "{{client_id}}",
								"type": "text"
							},
							{
								"key": "x-client-secret",
								"value": "{{client_secret}}",
								"type": "text"
							}
						],
						"url": "{{base_url}}/fips"
					},
					"response": []
				}
			],
			"_postman_id": "16f66a9e-f148-46ed-ad25-5bbf4a546a2f"
		}
	],
	"event": [
		{
			"listen": "prerequest",
			"script": {
				"id": "26e45724-defb-4fee-8bf7-5b8e5515c2e6",
				"type": "text/javascript",
				"exec": [
					""
				]
			}
		},
		{
			"listen": "test",
			"script": {
				"id": "ab7105c9-0ebf-416b-acf7-06d589681ed9",
				"type": "text/javascript",
				"exec": [
					""
				]
			}
		}
	],
	"variable": [
		{
			"id": "26c7a96f-5908-4419-bd53-f0123f3b7468",
			"key": "base_url",
			"value": "https://fiu-uat.setu.co",
			"type": "string"
		},
		{
			"id": "5b1c1420-d9db-4218-b5b3-2bcc7da14863",
			"key": "mobile_number",
			"value": "9751644338",
			"type": "string"
		},
		{
			"id": "4512b77e-3ef7-4ecb-be8b-ae90edc60248",
			"key": "client_id",
			"value": "255d0b6c-492d-44cf-8581-e9494c7b0914\n",
			"type": "string"
		},
		{
			"id": "b2a186a3-41bd-49a9-92c4-fbd27cce6115",
			"key": "client_secret",
			"value": "9c2fc756-3d17-46d6-b28d-be4d71953e83",
			"type": "string"
		},
		{
			"id": "0e8f4c1c-d71e-4403-ac8f-6b64cc82c0be",
			"key": "consent_request_id",
			"value": "",
			"type": "string",
			"disabled": true
		},
		{
			"id": "54cc280c-3bad-4760-a8f3-f01e55c9ae1d",
			"key": "fi_data_request_id",
			"value": "",
			"type": "string",
			"disabled": true
		},
		{
			"id": "281b5d6c-720c-48fd-b124-ada84f7f13dd",
			"key": "consent_request_id",
			"value": "",
			"type": "string"
		},
		{
			"id": "947a1708-8856-4700-80cb-8fb064b697ce",
			"key": "fi_data_request_id",
			"value": "",
			"type": "string"
		}
	]
}